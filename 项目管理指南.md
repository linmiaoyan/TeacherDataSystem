# 多项目管理指南

## 一、当前项目结构

### 已创建的文件
- `1push.bat` - 提交并推送到GitHub
- `2pull_normal.bat` - 从GitHub拉取最新代码
- `.gitignore` - Git忽略文件配置

### 使用说明

#### 首次使用
1. **配置GitHub仓库地址**
   - 打开 `1push.bat` 和 `2pull_normal.bat`
   - 修改 `GITHUB_URL` 变量为你的实际仓库地址
   - 例如：`set GITHUB_URL=https://github.com/你的用户名/仓库名.git`

2. **初始化Git仓库（如果还没有）**
   - 运行 `2pull_normal.bat` 会自动初始化

3. **首次推送**
   - 运行 `1push.bat` 提交并推送代码

#### 日常使用
- **上传代码**：双击运行 `1push.bat`，输入提交描述即可
- **下载代码**：双击运行 `2pull_normal.bat` 即可拉取最新代码

## 二、多项目管理方案

### 方案一：统一脚本模板（推荐）

创建一个通用的脚本模板，然后为每个项目复制并修改。

#### 步骤1：创建模板目录
```
D:\OneDrive\09教育技术处\
├── Git脚本模板\
│   ├── 1push_template.bat
│   ├── 2pull_template.bat
│   └── .gitignore_template
├── 项目1\
├── 项目2\
└── 项目3\
```

#### 步骤2：创建模板脚本

**1push_template.bat**（模板）
```batch
@echo off
setlocal enabledelayedexpansion
chcp 65001 >nul

REM ============================================
REM 配置区域 - 每个项目需要修改这里
REM ============================================
set PROJECT_NAME=项目名称
set GITHUB_URL=https://github.com/用户名/仓库名.git
REM ============================================

echo ============================================
echo Git 提交并推送 - %PROJECT_NAME%
echo ============================================
echo.

cd /d "%~dp0"

REM 检查Git是否安装
git --version >nul 2>&1
if %errorlevel% neq 0 (
    echo [错误] 未检测到 Git，请先安装 Git for Windows
    pause
    exit /b 1
)

echo [步骤1] 添加所有文件
git add .
if %errorlevel% neq 0 (
    echo [错误] 添加文件失败
    pause
    exit /b 1
)
echo [成功] 文件已添加到暂存区
echo.

echo [步骤2] 提交更改
echo.
set /p commit_msg="请输入提交描述: "

if "!commit_msg!"=="" (
    echo [错误] 提交描述不能为空
    pause
    exit /b 1
)

git commit -m "!commit_msg!"
if %errorlevel% neq 0 (
    echo [错误] 提交失败
    pause
    exit /b 1
)
echo [成功] 代码已提交
echo.

echo [步骤3] 推送到GitHub
git push origin main
if %errorlevel% equ 0 (
    echo.
    echo ============================================
    echo [成功] 代码已推送到GitHub
    echo ============================================
    echo.
    echo 仓库地址：%GITHUB_URL%
    echo.
) else (
    echo.
    echo [错误] 推送失败
    echo.
    echo 可能的原因：
    echo 1. 网络连接问题
    echo 2. 认证失败（需要Personal Access Token）
    echo 3. 权限不足
    echo 4. 远程仓库地址未配置或配置错误
    echo.
)

pause
```

**2pull_template.bat**（模板）
```batch
@echo off
setlocal enabledelayedexpansion
chcp 65001 >nul

REM ============================================
REM 配置区域 - 每个项目需要修改这里
REM ============================================
set PROJECT_NAME=项目名称
set GITHUB_URL=https://github.com/用户名/仓库名.git
REM ============================================

echo ============================================
echo 服务器代码更新 - %PROJECT_NAME%
echo ============================================
echo.

cd /d "%~dp0"

REM 检查是否在Git仓库中
if not exist ".git" (
    echo [提示] 当前目录不是Git仓库，正在初始化...
    git init
    git branch -M main
    echo [成功] Git仓库已初始化
    echo.
)

REM 检查远程仓库是否已配置
git remote | findstr /C:"origin" >nul 2>&1
if %errorlevel% equ 0 (
    echo [成功] 远程仓库已配置
    for /f "tokens=*" %%a in ('git remote get-url origin 2^>nul') do set CURRENT_URL=%%a
    echo 当前远程地址: !CURRENT_URL!
    echo.
    
    REM 检查URL是否正确
    if not "!CURRENT_URL!"=="!GITHUB_URL!" (
        echo [提示] 远程地址不匹配，正在更新...
        git remote set-url origin !GITHUB_URL!
        echo [成功] 远程地址已更新
        echo.
    )
    
    echo [步骤] 正在拉取最新代码...
    git pull origin main
    
    if %errorlevel% equ 0 (
        echo.
        echo [成功] 代码更新成功
    ) else (
        echo.
        echo [错误] 代码更新失败
        pause
        exit /b 1
    )
) else (
    echo [提示] 远程仓库未配置，正在配置...
    git remote add origin !GITHUB_URL!
    echo [成功] 远程仓库已配置
    echo.
    
    echo [步骤] 正在拉取最新代码...
    git pull origin main
    
    if %errorlevel% equ 0 (
        echo.
        echo [成功] 代码更新成功
    ) else (
        echo.
        echo [错误] 代码更新失败
        echo.
        echo [提示] 如果这是首次配置，可能需要先推送代码到GitHub
        pause
        exit /b 1
    )
)

echo.
echo ============================================
pause
```

#### 步骤3：为新项目快速创建脚本

创建一个辅助脚本 `创建项目脚本.bat`：

```batch
@echo off
setlocal enabledelayedexpansion
chcp 65001 >nul

echo ============================================
echo 为新项目创建Git脚本
echo ============================================
echo.

set /p PROJECT_PATH="请输入项目路径（完整路径）: "
set /p PROJECT_NAME="请输入项目名称: "
set /p GITHUB_URL="请输入GitHub仓库地址: "

if "!PROJECT_PATH!"=="" (
    echo [错误] 项目路径不能为空
    pause
    exit /b 1
)

if "!PROJECT_NAME!"=="" (
    echo [错误] 项目名称不能为空
    pause
    exit /b 1
)

if "!GITHUB_URL!"=="" (
    echo [错误] GitHub仓库地址不能为空
    pause
    exit /b 1
)

REM 检查项目路径是否存在
if not exist "!PROJECT_PATH!" (
    echo [错误] 项目路径不存在: !PROJECT_PATH!
    pause
    exit /b 1
)

REM 复制模板文件
set TEMPLATE_DIR=%~dp0Git脚本模板
if not exist "!TEMPLATE_DIR!" (
    echo [错误] 模板目录不存在: !TEMPLATE_DIR!
    pause
    exit /b 1
)

echo [步骤] 正在创建脚本文件...

REM 复制并修改push脚本
copy "!TEMPLATE_DIR!\1push_template.bat" "!PROJECT_PATH!\1push.bat" >nul
powershell -Command "(Get-Content '!PROJECT_PATH!\1push.bat') -replace 'set PROJECT_NAME=项目名称', 'set PROJECT_NAME=!PROJECT_NAME!' -replace 'set GITHUB_URL=https://github.com/用户名/仓库名.git', 'set GITHUB_URL=!GITHUB_URL!' | Set-Content '!PROJECT_PATH!\1push.bat'"

REM 复制并修改pull脚本
copy "!TEMPLATE_DIR!\2pull_template.bat" "!PROJECT_PATH!\2pull_normal.bat" >nul
powershell -Command "(Get-Content '!PROJECT_PATH!\2pull_normal.bat') -replace 'set PROJECT_NAME=项目名称', 'set PROJECT_NAME=!PROJECT_NAME!' -replace 'set GITHUB_URL=https://github.com/用户名/仓库名.git', 'set GITHUB_URL=!GITHUB_URL!' | Set-Content '!PROJECT_PATH!\2pull_normal.bat'"

REM 复制.gitignore
if exist "!TEMPLATE_DIR!\.gitignore_template" (
    copy "!TEMPLATE_DIR!\.gitignore_template" "!PROJECT_PATH!\.gitignore" >nul
)

echo.
echo [成功] 脚本已创建完成！
echo.
echo 项目路径: !PROJECT_PATH!
echo 已创建文件:
echo   - 1push.bat
echo   - 2pull_normal.bat
echo   - .gitignore
echo.
pause
```

### 方案二：统一管理脚本（高级）

创建一个统一的管理脚本，可以管理所有项目。

**项目管理器.bat**
```batch
@echo off
setlocal enabledelayedexpansion
chcp 65001 >nul

echo ============================================
echo 多项目管理器
echo ============================================
echo.

REM 项目配置（可以放在单独的配置文件中）
set PROJECTS[1].NAME=教师数据自填系统
set PROJECTS[1].PATH=D:\OneDrive\09教育技术处\教师数据自填系统
set PROJECTS[1].URL=https://github.com/linmiaoyan/TeacherDataSystem.git

set PROJECTS[2].NAME=WzkjHomepage
set PROJECTS[2].PATH=D:\OneDrive\09教育技术处\WzkjHomepage
set PROJECTS[2].URL=https://github.com/linmiaoyan/WzkjgzHomePage.git

REM 显示项目列表
echo 可用项目：
echo.
set /a index=1
:list_loop
if defined PROJECTS[!index!].NAME (
    echo [!index!] !PROJECTS[!index!].NAME!
    set /a index+=1
    goto list_loop
)
echo.

set /p project_choice="请选择项目编号: "
set /a project_choice=!project_choice!

if not defined PROJECTS[!project_choice!].NAME (
    echo [错误] 无效的项目编号
    pause
    exit /b 1
)

set SELECTED_PATH=!PROJECTS[!project_choice!].PATH!
set SELECTED_NAME=!PROJECTS[!project_choice!].NAME!

echo.
echo 已选择项目: !SELECTED_NAME!
echo 项目路径: !SELECTED_PATH!
echo.

echo 请选择操作：
echo [1] 推送代码到GitHub
echo [2] 拉取代码从GitHub
echo.
set /p action="请输入操作编号: "

cd /d "!SELECTED_PATH!"

if "!action!"=="1" (
    call "!SELECTED_PATH!\1push.bat"
) else if "!action!"=="2" (
    call "!SELECTED_PATH!\2pull_normal.bat"
) else (
    echo [错误] 无效的操作编号
    pause
    exit /b 1
)
```

### 方案三：使用配置文件（最灵活）

创建一个JSON或INI格式的配置文件，统一管理所有项目。

**projects.json**
```json
{
  "projects": [
    {
      "name": "教师数据自填系统",
      "path": "D:\\OneDrive\\09教育技术处\\教师数据自填系统",
      "github_url": "https://github.com/linmiaoyan/TeacherDataSystem.git"
    },
    {
      "name": "WzkjHomepage",
      "path": "D:\\OneDrive\\09教育技术处\\WzkjHomepage",
      "github_url": "https://github.com/linmiaoyan/WzkjgzHomePage.git"
    }
  ]
}
```

## 三、最佳实践建议

### 1. 项目结构标准化
```
项目根目录/
├── 1push.bat          # 上传脚本
├── 2pull_normal.bat   # 下载脚本
├── .gitignore         # Git忽略文件
├── README.md          # 项目说明
└── ...                # 项目文件
```

### 2. 命名规范
- 上传脚本：`1push.bat`（统一命名，方便查找）
- 下载脚本：`2pull_normal.bat`（统一命名）
- 项目文件夹：使用有意义的名称

### 3. 配置管理
- **敏感信息**：不要将包含密码、密钥的配置文件提交到Git
- **环境配置**：使用 `config.py.example` 作为配置模板
- **数据库文件**：添加到 `.gitignore`，不要提交到Git

### 4. 版本控制
- 每次重要功能更新后及时提交
- 提交信息要清晰明确
- 定期推送到远程仓库

### 5. 备份策略
- 本地Git仓库 + GitHub远程仓库（双重备份）
- 重要数据定期导出备份
- 数据库文件单独备份

## 四、快速开始新项目

### 步骤1：创建项目文件夹
```
D:\OneDrive\09教育技术处\新项目名称\
```

### 步骤2：复制脚本模板
从模板目录复制 `1push_template.bat` 和 `2pull_template.bat` 到项目目录

### 步骤3：修改配置
在脚本中修改：
- `PROJECT_NAME` - 项目名称
- `GITHUB_URL` - GitHub仓库地址

### 步骤4：初始化Git
运行 `2pull_normal.bat` 初始化Git仓库

### 步骤5：首次推送
运行 `1push.bat` 推送初始代码

## 五、常见问题

### Q1: 如何修改GitHub仓库地址？
A: 编辑 `1push.bat` 和 `2pull_normal.bat`，修改 `GITHUB_URL` 变量

### Q2: 推送时提示认证失败？
A: 需要配置GitHub Personal Access Token，或使用SSH方式

### Q3: 如何添加新项目？
A: 使用方案一的模板脚本，或手动复制并修改现有脚本

### Q4: 多个项目可以共用一个GitHub账号吗？
A: 可以，每个项目使用不同的仓库即可

## 六、推荐方案

**对于少量项目（2-5个）**：使用方案一（统一脚本模板）
- 简单直接
- 每个项目独立管理
- 易于维护

**对于中等数量项目（5-10个）**：使用方案二（统一管理脚本）
- 集中管理
- 快速切换项目
- 减少重复操作

**对于大量项目（10+个）**：使用方案三（配置文件）
- 灵活配置
- 易于扩展
- 可以配合其他工具使用

---

**建议**：从方案一开始，随着项目增多再逐步升级到更高级的方案。
